dist: trusty
sudo: required
language: cpp
cache: ccache
services:
  - docker
install:
  - mkdir deps && cd deps
  - git clone https://github.com/intel/gmmlib.git gmmlib
  - cd ..

script:
  - rm -rf build && mkdir build
  - mkdir -p $HOME/.ccache
  - ccache -s
  - ccache -z
  - >
      docker run
      -v $HOME/.ccache:/opt/ccache
      -v ${TRAVIS_BUILD_DIR}:/opt/src
      -w /opt/src/build
      -e CCACHE_DIR=/opt/ccache
      intelmediadriver/media-driver-docker
      cmake
  - >
      docker run
      -v $HOME/.ccache:/opt/ccache
      -v ${TRAVIS_BUILD_DIR}:/opt/src
      -w /opt/src/build
      -e CCACHE_DIR=/opt/ccache
      intelmediadriver/media-driver-docker
      cmake  --build . -- -j 8
  - ccache -s
